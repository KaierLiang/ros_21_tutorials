function [M,h,Bg] = func_MhBg(in1,in2)
%FUNC_MHBG
%    [M,H,BG] = FUNC_MHBG(IN1,IN2)

%    This function was generated by the Symbolic Math Toolbox version 8.4.
%    27-Jul-2020 06:26:22

Ib_1 = in2(5,:);
Ib_2 = in2(6,:);
Ib_3 = in2(7,:);
Ic_xx = in2(8,:);
Ic_yy = in2(9,:);
Ic_zz = in2(10,:);
L1_L_1 = in2(11,:);
L1_L_2 = in2(12,:);
L1_L_3 = in2(13,:);
L1_R_1 = in2(20,:);
L1_R_2 = in2(21,:);
L1_R_3 = in2(22,:);
L2_L_1 = in2(14,:);
L2_L_2 = in2(15,:);
L2_L_3 = in2(16,:);
L2_R_1 = in2(23,:);
L2_R_2 = in2(24,:);
L2_R_3 = in2(25,:);
L3_L_1 = in2(17,:);
L3_L_2 = in2(18,:);
L3_L_3 = in2(19,:);
L3_R_1 = in2(26,:);
L3_R_2 = in2(27,:);
L3_R_3 = in2(28,:);
Rb_1_1 = in1(18,:);
Rb_1_2 = in1(21,:);
Rb_1_3 = in1(24,:);
Rb_2_1 = in1(19,:);
Rb_2_2 = in1(22,:);
Rb_2_3 = in1(25,:);
Rb_3_1 = in1(20,:);
Rb_3_2 = in1(23,:);
Rb_3_3 = in1(26,:);
g = in2(4,:);
l4a = in2(29,:);
l4b = in2(30,:);
mb = in2(1,:);
mh = in2(2,:);
mk = in2(3,:);
qD_hF_1 = in1(8,:);
qD_hF_2 = in1(10,:);
qD_hS_1 = in1(9,:);
qD_hS_2 = in1(11,:);
q_hF_1 = in1(1,:);
q_hF_2 = in1(3,:);
q_hS_1 = in1(2,:);
q_hS_2 = in1(4,:);
q_kS_1 = in1(27,:);
q_kS_2 = in1(28,:);
vb_1 = in1(12,:);
vb_2 = in1(13,:);
vb_3 = in1(14,:);
wb_1 = in1(15,:);
wb_2 = in1(16,:);
wb_3 = in1(17,:);
M = reshape([Ic_xx.*2.0+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).^2+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).^2+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).^2+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).^2+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).^2+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).^2,-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),0.0,0.0,(mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0))./2.0,(mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0))./2.0,(mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0))./2.0,Ic_xx.*2.0+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2)+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2)+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2)+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)),-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),Ic_yy+mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).^2+mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).^2+mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).^2,0.0,0.0,mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))).*2.0-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))).*2.0).*(-1.0./2.0),mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))).*2.0-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))).*2.0).*(-1.0./2.0),mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))).*2.0-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))).*2.0).*(-1.0./2.0),-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),Ic_yy.*cos(q_hF_1)+mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))+mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))+mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)),Ic_yy.*sin(q_hF_1)-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)),0.0,0.0,Ic_xx.*2.0+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).^2+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).^2+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).^2+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).^2+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).^2+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).^2,-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),(mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0))./2.0,(mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0))./2.0,(mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0))./2.0,Ic_xx.*2.0+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2)+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2)+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2)+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),0.0,0.0,-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),Ic_yy+mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).^2+mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).^2+mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).^2,mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))).*2.0-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))).*2.0).*(-1.0./2.0),mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))).*2.0-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))).*2.0).*(-1.0./2.0),mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))).*2.0-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))).*2.0).*(-1.0./2.0),-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),Ic_yy.*cos(q_hF_2)+mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))+mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))+mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),Ic_yy.*sin(q_hF_2)-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))),-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))),mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))),-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))),mb+mh.*2.0+mk.*2.0,0.0,0.0,mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2)+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2)+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))),-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)),mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))),-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))),mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))),-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))),0.0,mb+mh.*2.0+mk.*2.0,0.0,mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2)+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2)+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))),-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)),mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))),mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))),0.0,0.0,mb+mh.*2.0+mk.*2.0,mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2)+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2)+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2))+mh.*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))+mh.*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)),mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),Ic_xx.*2.0+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2)+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2)+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2)+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))),Ic_xx.*2.0+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2)+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2)+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2)+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))),(mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_1_3.*2.0-L1_L_3.*Rb_1_2.*2.0))./2.0+(mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_1_3.*2.0-L1_R_3.*Rb_1_2.*2.0))./2.0+(mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_1_3.*2.0-L1_L_3.*Rb_1_2.*2.0+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_1_3.*2.0-L1_R_3.*Rb_1_2.*2.0+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)).*2.0))./2.0,(mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_2_3.*2.0-L1_L_3.*Rb_2_2.*2.0))./2.0+(mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_2_3.*2.0-L1_R_3.*Rb_2_2.*2.0))./2.0+(mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_2_3.*2.0-L1_L_3.*Rb_2_2.*2.0+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_2_3.*2.0-L1_R_3.*Rb_2_2.*2.0+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)).*2.0))./2.0,(mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_3_3.*2.0-L1_L_3.*Rb_3_2.*2.0))./2.0+(mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_3_3.*2.0-L1_R_3.*Rb_3_2.*2.0))./2.0+(mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)).*2.0+L1_L_2.*Rb_3_3.*2.0-L1_L_3.*Rb_3_2.*2.0+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)).*2.0))./2.0+(mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)).*2.0+L1_R_2.*Rb_3_3.*2.0-L1_R_3.*Rb_3_2.*2.0+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)).*2.0))./2.0,Ib_1+Ic_xx.*4.0+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).^2+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).^2+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).^2+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).^2+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).^2+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).^2+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).^2+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).^2+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).^2+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).^2+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).^2+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).^2,mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))-mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)),Ic_yy.*cos(q_hF_1)+mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))+mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))+mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)),mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))-mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),Ic_yy.*cos(q_hF_2)+mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))+mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))+mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1)).*2.0+L1_L_1.*Rb_1_3.*2.0-L1_L_3.*Rb_1_1.*2.0+L2_L_1.*Rb_1_3.*2.0-L2_L_3.*Rb_1_1.*cos(q_hF_1).*2.0-L2_L_2.*Rb_1_1.*sin(q_hF_1).*2.0-L3_L_2.*Rb_1_1.*sin(q_hF_1).*2.0).*(-1.0./2.0)-(mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2)).*2.0+L1_R_1.*Rb_1_3.*2.0-L1_R_3.*Rb_1_1.*2.0+L2_R_1.*Rb_1_3.*2.0-L2_R_3.*Rb_1_1.*cos(q_hF_2).*2.0-L2_R_2.*Rb_1_1.*sin(q_hF_2).*2.0-L3_R_2.*Rb_1_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_1_3.*-2.0+L1_L_3.*Rb_1_1.*2.0-L2_L_1.*Rb_1_3.*2.0+L2_L_3.*Rb_1_1.*cos(q_hF_1).*2.0+L2_L_2.*Rb_1_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_1_3.*-2.0+L1_R_3.*Rb_1_1.*2.0-L2_R_1.*Rb_1_3.*2.0+L2_R_3.*Rb_1_1.*cos(q_hF_2).*2.0+L2_R_2.*Rb_1_1.*sin(q_hF_2).*2.0))./2.0,mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1)).*2.0+L1_L_1.*Rb_2_3.*2.0-L1_L_3.*Rb_2_1.*2.0+L2_L_1.*Rb_2_3.*2.0-L2_L_3.*Rb_2_1.*cos(q_hF_1).*2.0-L2_L_2.*Rb_2_1.*sin(q_hF_1).*2.0-L3_L_2.*Rb_2_1.*sin(q_hF_1).*2.0).*(-1.0./2.0)-(mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2)).*2.0+L1_R_1.*Rb_2_3.*2.0-L1_R_3.*Rb_2_1.*2.0+L2_R_1.*Rb_2_3.*2.0-L2_R_3.*Rb_2_1.*cos(q_hF_2).*2.0-L2_R_2.*Rb_2_1.*sin(q_hF_2).*2.0-L3_R_2.*Rb_2_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_2_3.*-2.0+L1_L_3.*Rb_2_1.*2.0-L2_L_1.*Rb_2_3.*2.0+L2_L_3.*Rb_2_1.*cos(q_hF_1).*2.0+L2_L_2.*Rb_2_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_2_3.*-2.0+L1_R_3.*Rb_2_1.*2.0-L2_R_1.*Rb_2_3.*2.0+L2_R_3.*Rb_2_1.*cos(q_hF_2).*2.0+L2_R_2.*Rb_2_1.*sin(q_hF_2).*2.0))./2.0,mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1)).*2.0+L1_L_1.*Rb_3_3.*2.0-L1_L_3.*Rb_3_1.*2.0+L2_L_1.*Rb_3_3.*2.0-L2_L_3.*Rb_3_1.*cos(q_hF_1).*2.0-L2_L_2.*Rb_3_1.*sin(q_hF_1).*2.0-L3_L_2.*Rb_3_1.*sin(q_hF_1).*2.0).*(-1.0./2.0)-(mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2)).*2.0+L1_R_1.*Rb_3_3.*2.0-L1_R_3.*Rb_3_1.*2.0+L2_R_1.*Rb_3_3.*2.0-L2_R_3.*Rb_3_1.*cos(q_hF_2).*2.0-L2_R_2.*Rb_3_1.*sin(q_hF_2).*2.0-L3_R_2.*Rb_3_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_3_3.*-2.0+L1_L_3.*Rb_3_1.*2.0-L2_L_1.*Rb_3_3.*2.0+L2_L_3.*Rb_3_1.*cos(q_hF_1).*2.0+L2_L_2.*Rb_3_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_3_3.*-2.0+L1_R_3.*Rb_3_1.*2.0-L2_R_1.*Rb_3_3.*2.0+L2_R_3.*Rb_3_1.*cos(q_hF_2).*2.0+L2_R_2.*Rb_3_1.*sin(q_hF_2).*2.0))./2.0,mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2))-mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1))-mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)),Ib_2+mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).^2+mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).^2+mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).^2+mh.*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1)).^2+mh.*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)).^2+mh.*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1)).^2+mh.*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)).^2+mh.*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1)).^2+mh.*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)).^2+Ic_yy.*cos(q_hF_1).^2.*2.0+Ic_yy.*cos(q_hF_2).^2.*2.0+Ic_zz.*sin(q_hF_1).^2.*2.0+Ic_zz.*sin(q_hF_2).^2.*2.0,Ic_yy.*cos(q_hF_1).*sin(q_hF_1).*2.0+Ic_yy.*cos(q_hF_2).*sin(q_hF_2).*2.0-Ic_zz.*cos(q_hF_1).*sin(q_hF_1).*2.0-Ic_zz.*cos(q_hF_2).*sin(q_hF_2).*2.0-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)),mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)),Ic_yy.*sin(q_hF_1)-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)),mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),Ic_yy.*sin(q_hF_2)-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),(mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1)).*2.0+L1_L_1.*Rb_1_2.*2.0-L1_L_2.*Rb_1_1.*2.0+L2_L_1.*Rb_1_2.*2.0-L2_L_2.*Rb_1_1.*cos(q_hF_1).*2.0-L3_L_2.*Rb_1_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_1_1.*sin(q_hF_1).*2.0))./2.0+(mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2)).*2.0+L1_R_1.*Rb_1_2.*2.0-L1_R_2.*Rb_1_1.*2.0+L2_R_1.*Rb_1_2.*2.0-L2_R_2.*Rb_1_1.*cos(q_hF_2).*2.0-L3_R_2.*Rb_1_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_1_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_1_2.*2.0-L1_L_2.*Rb_1_1.*2.0+L2_L_1.*Rb_1_2.*2.0-L2_L_2.*Rb_1_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_1_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_1_2.*2.0-L1_R_2.*Rb_1_1.*2.0+L2_R_1.*Rb_1_2.*2.0-L2_R_2.*Rb_1_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_1_1.*sin(q_hF_2).*2.0))./2.0,(mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1)).*2.0+L1_L_1.*Rb_2_2.*2.0-L1_L_2.*Rb_2_1.*2.0+L2_L_1.*Rb_2_2.*2.0-L2_L_2.*Rb_2_1.*cos(q_hF_1).*2.0-L3_L_2.*Rb_2_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_2_1.*sin(q_hF_1).*2.0))./2.0+(mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2)).*2.0+L1_R_1.*Rb_2_2.*2.0-L1_R_2.*Rb_2_1.*2.0+L2_R_1.*Rb_2_2.*2.0-L2_R_2.*Rb_2_1.*cos(q_hF_2).*2.0-L3_R_2.*Rb_2_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_2_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_2_2.*2.0-L1_L_2.*Rb_2_1.*2.0+L2_L_1.*Rb_2_2.*2.0-L2_L_2.*Rb_2_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_2_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_2_2.*2.0-L1_R_2.*Rb_2_1.*2.0+L2_R_1.*Rb_2_2.*2.0-L2_R_2.*Rb_2_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_2_1.*sin(q_hF_2).*2.0))./2.0,(mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1)).*2.0+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1)).*2.0+L1_L_1.*Rb_3_2.*2.0-L1_L_2.*Rb_3_1.*2.0+L2_L_1.*Rb_3_2.*2.0-L2_L_2.*Rb_3_1.*cos(q_hF_1).*2.0-L3_L_2.*Rb_3_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_3_1.*sin(q_hF_1).*2.0))./2.0+(mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2)).*2.0+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2)).*2.0+L1_R_1.*Rb_3_2.*2.0-L1_R_2.*Rb_3_1.*2.0+L2_R_1.*Rb_3_2.*2.0-L2_R_2.*Rb_3_1.*cos(q_hF_2).*2.0-L3_R_2.*Rb_3_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_3_1.*sin(q_hF_2).*2.0))./2.0+(mh.*(L1_L_1.*Rb_3_2.*2.0-L1_L_2.*Rb_3_1.*2.0+L2_L_1.*Rb_3_2.*2.0-L2_L_2.*Rb_3_1.*cos(q_hF_1).*2.0+L2_L_3.*Rb_3_1.*sin(q_hF_1).*2.0))./2.0+(mh.*(L1_R_1.*Rb_3_2.*2.0-L1_R_2.*Rb_3_1.*2.0+L2_R_1.*Rb_3_2.*2.0-L2_R_2.*Rb_3_1.*cos(q_hF_2).*2.0+L2_R_3.*Rb_3_1.*sin(q_hF_2).*2.0))./2.0,mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)),Ic_yy.*cos(q_hF_1).*sin(q_hF_1).*2.0+Ic_yy.*cos(q_hF_2).*sin(q_hF_2).*2.0-Ic_zz.*cos(q_hF_1).*sin(q_hF_1).*2.0-Ic_zz.*cos(q_hF_2).*sin(q_hF_2).*2.0-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)),Ib_3+mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).^2+mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).^2+mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).^2+mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).^2+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).^2+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).^2+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).^2+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).^2+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).^2+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).^2+Ic_zz.*cos(q_hF_1).^2.*2.0+Ic_zz.*cos(q_hF_2).^2.*2.0+Ic_yy.*sin(q_hF_1).^2.*2.0+Ic_yy.*sin(q_hF_2).^2.*2.0],[10,10]);
if nargout > 1
    h = [mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+g.*mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)))-Ic_yy.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))+Ic_zz.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0-mk.*(-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)))+L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)))+L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)))+L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))-Ic_yy.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+g.*mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)));(Ic_yy.*(qD_hF_1.*wb_3.*cos(q_hF_1).*2.0-qD_hF_1.*wb_2.*sin(q_hF_1).*2.0))./2.0-g.*mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))))-mk.*(L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))-mk.*(L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))-mk.*(L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0));mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+g.*mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)))-Ic_yy.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))+Ic_zz.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0-mk.*(-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)))+L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)))+L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)))+L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))-Ic_yy.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+g.*mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)));(Ic_yy.*(qD_hF_2.*wb_3.*cos(q_hF_2).*2.0-qD_hF_2.*wb_2.*sin(q_hF_2).*2.0))./2.0-g.*mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))))-mk.*(L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))-mk.*(L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))-mk.*(L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0));(mh.*(L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0).*2.0))./2.0+(mh.*(L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*2.0-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0).*2.0+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)).*2.0-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0).*2.0+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0).*2.0))./2.0;(mh.*(L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0).*2.0))./2.0+(mh.*(L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*2.0-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0).*2.0+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)).*2.0-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0).*2.0+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0).*2.0))./2.0;g.*mb+g.*mh.*2.0+g.*mk.*2.0+(mh.*(L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0).*2.0))./2.0+(mh.*(L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*-2.0+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*2.0-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0).*2.0+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0).*2.0+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0))./2.0+(mk.*(L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*-2.0+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)).*2.0-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)).*2.0-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0).*2.0+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0).*2.0+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0).*2.0))./2.0;-wb_3.*(Ib_2.*wb_2+Ic_yy.*cos(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*cos(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-Ic_zz.*sin(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0-Ic_zz.*sin(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0+Ic_yy.*cos(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*cos(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))))-Rb_1_2.*(mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))+Rb_1_3.*(mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))-Rb_2_2.*(mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))+Rb_2_3.*(mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))-Rb_3_2.*(g.*mk.*(L1_L_3+L2_L_3.*cos(q_hF_1)+L2_L_2.*sin(q_hF_1)+L3_L_2.*sin(q_hF_1)+L3_L_3.*cos(q_hF_1).*cos(q_hS_1)-L3_L_1.*cos(q_hF_1).*sin(q_hS_1))+g.*mk.*(L1_R_3+L2_R_3.*cos(q_hF_2)+L2_R_2.*sin(q_hF_2)+L3_R_2.*sin(q_hF_2)+L3_R_3.*cos(q_hF_2).*cos(q_hS_2)-L3_R_1.*cos(q_hF_2).*sin(q_hS_2))+mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+g.*mh.*(L1_L_3+L2_L_3.*cos(q_hF_1)+L2_L_2.*sin(q_hF_1))+g.*mh.*(L1_R_3+L2_R_3.*cos(q_hF_2)+L2_R_2.*sin(q_hF_2)))+wb_2.*(Ib_3.*wb_3+Ic_zz.*cos(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0+Ic_zz.*cos(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0+Ic_yy.*sin(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*sin(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+Ic_yy.*sin(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*sin(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))+Rb_3_3.*(g.*mk.*(L1_L_2+L2_L_2.*cos(q_hF_1)+L3_L_2.*cos(q_hF_1)-L2_L_3.*sin(q_hF_1)-L3_L_3.*cos(q_hS_1).*sin(q_hF_1)+L3_L_1.*sin(q_hF_1).*sin(q_hS_1))+g.*mk.*(L1_R_2+L2_R_2.*cos(q_hF_2)+L3_R_2.*cos(q_hF_2)-L2_R_3.*sin(q_hF_2)-L3_R_3.*cos(q_hS_2).*sin(q_hF_2)+L3_R_1.*sin(q_hF_2).*sin(q_hS_2))+mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+g.*mh.*(L1_L_2+L2_L_2.*cos(q_hF_1)-L2_L_3.*sin(q_hF_1))+g.*mh.*(L1_R_2+L2_R_2.*cos(q_hF_2)-L2_R_3.*sin(q_hF_2)))+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+mk.*(L1_L_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_L_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_R_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_L_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_R_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_L_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L3_L_3.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))-L3_L_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L3_L_1.*qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_3.*qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_R_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L3_R_3.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))-L3_R_1.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L3_R_1.*qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_3.*qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_L_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_R_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_L_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_R_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_L_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_R_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0));Rb_1_1.*(mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))+Rb_2_1.*(mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))+wb_3.*(Ib_1.*wb_1+Ic_xx.*(qD_hF_1.*2.0+wb_1.*2.0)+Ic_xx.*(qD_hF_2.*2.0+wb_1.*2.0)+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))+Rb_3_1.*(g.*mk.*(L1_L_3+L2_L_3.*cos(q_hF_1)+L2_L_2.*sin(q_hF_1)+L3_L_2.*sin(q_hF_1)+L3_L_3.*cos(q_hF_1).*cos(q_hS_1)-L3_L_1.*cos(q_hF_1).*sin(q_hS_1))+g.*mk.*(L1_R_3+L2_R_3.*cos(q_hF_2)+L2_R_2.*sin(q_hF_2)+L3_R_2.*sin(q_hF_2)+L3_R_3.*cos(q_hF_2).*cos(q_hS_2)-L3_R_1.*cos(q_hF_2).*sin(q_hS_2))+mh.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_1.*wb_2-L1_L_2.*wb_1+L2_L_1.*wb_2+L3_L_1.*(-sin(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*cos(q_hS_1)+qD_hS_1.*cos(q_hF_1).*cos(q_hS_1))+L3_L_3.*(cos(q_hS_1).*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))+wb_2.*sin(q_hS_1)+qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L2_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L3_L_2.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_3.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_1.*wb_2-L1_R_2.*wb_1+L2_R_1.*wb_2+L3_R_1.*(-sin(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*cos(q_hS_2)+qD_hS_2.*cos(q_hF_2).*cos(q_hS_2))+L3_R_3.*(cos(q_hS_2).*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))+wb_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L2_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L3_R_2.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_3.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+g.*mh.*(L1_L_3+L2_L_3.*cos(q_hF_1)+L2_L_2.*sin(q_hF_1))+g.*mh.*(L1_R_3+L2_R_3.*cos(q_hF_2)+L2_R_2.*sin(q_hF_2)))-Rb_3_3.*(g.*mh.*(L1_L_1+L2_L_1)+g.*mh.*(L1_R_1+L2_R_1)+g.*mk.*(L1_L_1+L2_L_1+L3_L_1.*cos(q_hS_1)+L3_L_3.*sin(q_hS_1))+g.*mk.*(L1_R_1+L2_R_1+L3_R_1.*cos(q_hS_2)+L3_R_3.*sin(q_hS_2))+mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))-wb_1.*(Ib_3.*wb_3+Ic_zz.*cos(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0+Ic_zz.*cos(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0+Ic_yy.*sin(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*sin(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+Ic_yy.*sin(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*sin(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))-Rb_1_3.*(mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))-Rb_2_3.*(mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))+Ic_yy.*cos(q_hF_1).*(qD_hF_1.*wb_3.*cos(q_hF_1)-qD_hF_1.*wb_2.*sin(q_hF_1)).*2.0+Ic_yy.*cos(q_hF_2).*(qD_hF_2.*wb_3.*cos(q_hF_2)-qD_hF_2.*wb_2.*sin(q_hF_2)).*2.0+Ic_zz.*sin(q_hF_1).*(qD_hF_1.*wb_2.*cos(q_hF_1)+qD_hF_1.*wb_3.*sin(q_hF_1)).*2.0+Ic_zz.*sin(q_hF_2).*(qD_hF_2.*wb_2.*cos(q_hF_2)+qD_hF_2.*wb_3.*sin(q_hF_2)).*2.0+mh.*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_L_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L2_L_3.*cos(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_2.*Rb_1_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_1_1.*qD_hF_1.*sin(q_hF_1))+mh.*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_R_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L2_R_3.*cos(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_2.*Rb_1_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_1_1.*qD_hF_2.*sin(q_hF_2))+mh.*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_L_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L2_L_3.*cos(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_2.*Rb_2_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_2_1.*qD_hF_1.*sin(q_hF_1))+mh.*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_R_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L2_R_3.*cos(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_2.*Rb_2_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_2_1.*qD_hF_2.*sin(q_hF_2))+mh.*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_L_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L2_L_3.*cos(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_2.*Rb_3_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_3_1.*qD_hF_1.*sin(q_hF_1))+mh.*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_R_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L2_R_3.*cos(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_2.*Rb_3_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_3_1.*qD_hF_2.*sin(q_hF_2))+mh.*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+mh.*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+mk.*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_L_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L3_L_3.*(sin(q_hS_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-cos(q_hF_1).*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_3.*qD_hS_1.*cos(q_hS_1)+Rb_1_1.*qD_hF_1.*cos(q_hS_1).*sin(q_hF_1)+Rb_1_1.*qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_1.*(cos(q_hS_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-Rb_1_3.*qD_hS_1.*sin(q_hS_1)+cos(q_hF_1).*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_1_1.*qD_hF_1.*sin(q_hF_1).*sin(q_hS_1))+L2_L_3.*cos(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L3_L_2.*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_2.*Rb_1_1.*qD_hF_1.*cos(q_hF_1)+L3_L_2.*Rb_1_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_1_1.*qD_hF_1.*sin(q_hF_1))+mk.*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+L1_R_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L3_R_3.*(sin(q_hS_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-cos(q_hF_2).*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_3.*qD_hS_2.*cos(q_hS_2)+Rb_1_1.*qD_hF_2.*cos(q_hS_2).*sin(q_hF_2)+Rb_1_1.*qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L3_R_1.*(cos(q_hS_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-Rb_1_3.*qD_hS_2.*sin(q_hS_2)+cos(q_hF_2).*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_1_1.*qD_hF_2.*sin(q_hF_2).*sin(q_hS_2))+L2_R_3.*cos(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L3_R_2.*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_2.*Rb_1_1.*qD_hF_2.*cos(q_hF_2)+L3_R_2.*Rb_1_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_1_1.*qD_hF_2.*sin(q_hF_2))+mk.*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_L_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L3_L_3.*(sin(q_hS_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-cos(q_hF_1).*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_3.*qD_hS_1.*cos(q_hS_1)+Rb_2_1.*qD_hF_1.*cos(q_hS_1).*sin(q_hF_1)+Rb_2_1.*qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_1.*(cos(q_hS_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-Rb_2_3.*qD_hS_1.*sin(q_hS_1)+cos(q_hF_1).*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_2_1.*qD_hF_1.*sin(q_hF_1).*sin(q_hS_1))+L2_L_3.*cos(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L3_L_2.*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_2.*Rb_2_1.*qD_hF_1.*cos(q_hF_1)+L3_L_2.*Rb_2_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_2_1.*qD_hF_1.*sin(q_hF_1))+mk.*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+L1_R_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L3_R_3.*(sin(q_hS_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-cos(q_hF_2).*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_3.*qD_hS_2.*cos(q_hS_2)+Rb_2_1.*qD_hF_2.*cos(q_hS_2).*sin(q_hF_2)+Rb_2_1.*qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L3_R_1.*(cos(q_hS_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-Rb_2_3.*qD_hS_2.*sin(q_hS_2)+cos(q_hF_2).*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_2_1.*qD_hF_2.*sin(q_hF_2).*sin(q_hS_2))+L2_R_3.*cos(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L3_R_2.*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_2.*Rb_2_1.*qD_hF_2.*cos(q_hF_2)+L3_R_2.*Rb_2_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_2_1.*qD_hF_2.*sin(q_hF_2))+mk.*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))).*(-L1_L_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_L_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L3_L_3.*(sin(q_hS_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-cos(q_hF_1).*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_3.*qD_hS_1.*cos(q_hS_1)+Rb_3_1.*qD_hF_1.*cos(q_hS_1).*sin(q_hF_1)+Rb_3_1.*qD_hS_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_1.*(cos(q_hS_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-Rb_3_3.*qD_hS_1.*sin(q_hS_1)+cos(q_hF_1).*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_3_1.*qD_hF_1.*sin(q_hF_1).*sin(q_hS_1))+L2_L_3.*cos(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_2.*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L3_L_2.*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_2.*Rb_3_1.*qD_hF_1.*cos(q_hF_1)+L3_L_2.*Rb_3_1.*qD_hF_1.*cos(q_hF_1)-L2_L_3.*Rb_3_1.*qD_hF_1.*sin(q_hF_1))+mk.*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))).*(-L1_R_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+L1_R_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L3_R_3.*(sin(q_hS_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-cos(q_hF_2).*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_3.*qD_hS_2.*cos(q_hS_2)+Rb_3_1.*qD_hF_2.*cos(q_hS_2).*sin(q_hF_2)+Rb_3_1.*qD_hS_2.*cos(q_hF_2).*sin(q_hS_2))-L3_R_1.*(cos(q_hS_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-Rb_3_3.*qD_hS_2.*sin(q_hS_2)+cos(q_hF_2).*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_3_1.*qD_hF_2.*sin(q_hF_2).*sin(q_hS_2))+L2_R_3.*cos(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_2.*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L3_R_2.*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_2.*Rb_3_1.*qD_hF_2.*cos(q_hF_2)+L3_R_2.*Rb_3_1.*qD_hF_2.*cos(q_hF_2)-L2_R_3.*Rb_3_1.*qD_hF_2.*sin(q_hF_2))-Ic_yy.*qD_hF_1.*sin(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))-Ic_yy.*qD_hF_2.*sin(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-Ic_zz.*qD_hF_1.*cos(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0-Ic_zz.*qD_hF_2.*cos(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0-Ic_yy.*qD_hF_1.*sin(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))-Ic_yy.*qD_hF_2.*sin(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2));wb_1.*(Ib_2.*wb_2+Ic_yy.*cos(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*cos(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-Ic_zz.*sin(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0-Ic_zz.*sin(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0+Ic_yy.*cos(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*cos(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-mk.*(L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_1_3-L1_L_3.*Rb_1_1+L2_L_1.*Rb_1_3-L2_L_3.*Rb_1_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_1_3-L1_R_3.*Rb_1_1+L2_R_1.*Rb_1_3-L2_R_3.*Rb_1_1.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_2_3-L1_L_3.*Rb_2_1+L2_L_1.*Rb_2_3-L2_L_3.*Rb_2_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_2_3-L1_R_3.*Rb_2_1+L2_R_1.*Rb_2_3-L2_R_3.*Rb_2_1.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))-mk.*(L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))+L1_L_1.*Rb_3_3-L1_L_3.*Rb_3_1+L2_L_1.*Rb_3_3-L2_L_3.*Rb_3_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))+L1_R_1.*Rb_3_3-L1_R_3.*Rb_3_1+L2_R_1.*Rb_3_3-L2_R_3.*Rb_3_1.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1)).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1)).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1)).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))))-Rb_1_1.*(mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))-Rb_2_1.*(mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))-wb_2.*(Ib_1.*wb_1+Ic_xx.*(qD_hF_1.*2.0+wb_1.*2.0)+Ic_xx.*(qD_hF_2.*2.0+wb_1.*2.0)+mh.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mh.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2)))+mk.*(L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))+Rb_3_2.*(g.*mh.*(L1_L_1+L2_L_1)+g.*mh.*(L1_R_1+L2_R_1)+g.*mk.*(L1_L_1+L2_L_1+L3_L_1.*cos(q_hS_1)+L3_L_3.*sin(q_hS_1))+g.*mk.*(L1_R_1+L2_R_1+L3_R_1.*cos(q_hS_2)+L3_R_3.*sin(q_hS_2))+mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))))-Rb_3_1.*(g.*mk.*(L1_L_2+L2_L_2.*cos(q_hF_1)+L3_L_2.*cos(q_hF_1)-L2_L_3.*sin(q_hF_1)-L3_L_3.*cos(q_hS_1).*sin(q_hF_1)+L3_L_1.*sin(q_hF_1).*sin(q_hS_1))+g.*mk.*(L1_R_2+L2_R_2.*cos(q_hF_2)+L3_R_2.*cos(q_hF_2)-L2_R_3.*sin(q_hF_2)-L3_R_3.*cos(q_hS_2).*sin(q_hF_2)+L3_R_1.*sin(q_hF_2).*sin(q_hS_2))+mh.*(-L1_L_1.*wb_3+L1_L_3.*wb_1-L2_L_1.*wb_3+L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(-L1_R_1.*wb_3+L1_R_3.*wb_1-L2_R_1.*wb_3+L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)))-mk.*(L1_L_1.*wb_3-L1_L_3.*wb_1+L2_L_1.*wb_3+L3_L_1.*(wb_3.*cos(q_hS_1)+sin(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L3_L_3.*(wb_3.*sin(q_hS_1)-cos(q_hS_1).*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))+qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_3.*(qD_hF_1.*cos(q_hF_1)+wb_1.*cos(q_hF_1))-L2_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))-L3_L_2.*(qD_hF_1.*sin(q_hF_1)+wb_1.*sin(q_hF_1))).*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1)))-mk.*(L1_R_1.*wb_3-L1_R_3.*wb_1+L2_R_1.*wb_3+L3_R_1.*(wb_3.*cos(q_hS_2)+sin(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L3_R_3.*(wb_3.*sin(q_hS_2)-cos(q_hS_2).*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))+qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))-L2_R_3.*(qD_hF_2.*cos(q_hF_2)+wb_1.*cos(q_hF_2))-L2_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))-L3_R_2.*(qD_hF_2.*sin(q_hF_2)+wb_1.*sin(q_hF_2))).*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2)))+g.*mh.*(L1_L_2+L2_L_2.*cos(q_hF_1)-L2_L_3.*sin(q_hF_1))+g.*mh.*(L1_R_2+L2_R_2.*cos(q_hF_2)-L2_R_3.*sin(q_hF_2)))+Rb_1_2.*(mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))))+Rb_2_2.*(mh.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)))+mh.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)))+mk.*(L1_L_2.*wb_3-L1_L_3.*wb_2+L2_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L2_L_3.*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+L3_L_2.*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1))-L3_L_3.*(qD_hS_1.*cos(q_hS_1)+cos(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1)))+L3_L_1.*(sin(q_hS_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1))).*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1)))+mk.*(L1_R_2.*wb_3-L1_R_3.*wb_2+L2_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L2_R_3.*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+L3_R_2.*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2))-L3_R_3.*(qD_hS_2.*cos(q_hS_2)+cos(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2)))+L3_R_1.*(sin(q_hS_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2))).*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))))-mk.*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+Rb_1_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-L3_L_3.*(-sin(q_hS_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+cos(q_hS_1).*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_2.*qD_hS_1.*cos(q_hS_1)+Rb_1_1.*qD_hF_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_1_1.*qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_1.*(cos(q_hS_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+Rb_1_2.*qD_hS_1.*sin(q_hS_1)+sin(q_hF_1).*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hF_1.*cos(q_hF_1).*sin(q_hS_1)+Rb_1_1.*qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L2_L_2.*cos(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L3_L_2.*cos(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_3.*Rb_1_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*qD_hF_1.*sin(q_hF_1)-L3_L_2.*Rb_1_1.*qD_hF_1.*sin(q_hF_1))-mk.*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+Rb_1_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-L3_R_3.*(-sin(q_hS_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+cos(q_hS_2).*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_2.*qD_hS_2.*cos(q_hS_2)+Rb_1_1.*qD_hF_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_1_1.*qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))+L3_R_1.*(cos(q_hS_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+Rb_1_2.*qD_hS_2.*sin(q_hS_2)+sin(q_hF_2).*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+Rb_1_1.*qD_hF_2.*cos(q_hF_2).*sin(q_hS_2)+Rb_1_1.*qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L2_R_2.*cos(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L3_R_2.*cos(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_3.*Rb_1_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*qD_hF_2.*sin(q_hF_2)-L3_R_2.*Rb_1_1.*qD_hF_2.*sin(q_hF_2))-mk.*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+Rb_2_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-L3_L_3.*(-sin(q_hS_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+cos(q_hS_1).*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_2.*qD_hS_1.*cos(q_hS_1)+Rb_2_1.*qD_hF_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_2_1.*qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_1.*(cos(q_hS_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+Rb_2_2.*qD_hS_1.*sin(q_hS_1)+sin(q_hF_1).*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hF_1.*cos(q_hF_1).*sin(q_hS_1)+Rb_2_1.*qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L2_L_2.*cos(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L3_L_2.*cos(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_3.*Rb_2_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*qD_hF_1.*sin(q_hF_1)-L3_L_2.*Rb_2_1.*qD_hF_1.*sin(q_hF_1))-mk.*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+Rb_2_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-L3_R_3.*(-sin(q_hS_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+cos(q_hS_2).*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_2.*qD_hS_2.*cos(q_hS_2)+Rb_2_1.*qD_hF_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_2_1.*qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))+L3_R_1.*(cos(q_hS_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+Rb_2_2.*qD_hS_2.*sin(q_hS_2)+sin(q_hF_2).*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+Rb_2_1.*qD_hF_2.*cos(q_hF_2).*sin(q_hS_2)+Rb_2_1.*qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L2_R_2.*cos(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L3_R_2.*cos(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_3.*Rb_2_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*qD_hF_2.*sin(q_hF_2)-L3_R_2.*Rb_2_1.*qD_hF_2.*sin(q_hF_2))-mk.*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_1.*sin(q_hS_1)+qD_hS_1.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))+sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_1.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+Rb_3_1.*qD_hS_1.*cos(q_hS_1))-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))-L3_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-L3_L_3.*(-sin(q_hS_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+cos(q_hS_1).*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_2.*qD_hS_1.*cos(q_hS_1)+Rb_3_1.*qD_hF_1.*cos(q_hF_1).*cos(q_hS_1)-Rb_3_1.*qD_hS_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_1.*(cos(q_hS_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+Rb_3_2.*qD_hS_1.*sin(q_hS_1)+sin(q_hF_1).*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hF_1.*cos(q_hF_1).*sin(q_hS_1)+Rb_3_1.*qD_hS_1.*cos(q_hS_1).*sin(q_hF_1))+L2_L_2.*cos(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L3_L_2.*cos(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_3.*Rb_3_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*qD_hF_1.*sin(q_hF_1)-L3_L_2.*Rb_3_1.*qD_hF_1.*sin(q_hF_1))-mk.*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hS_2.*sin(q_hS_2)+qD_hS_2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))+sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-qD_hS_2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+Rb_3_1.*qD_hS_2.*cos(q_hS_2))-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))-L3_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-L3_R_3.*(-sin(q_hS_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+cos(q_hS_2).*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_2.*qD_hS_2.*cos(q_hS_2)+Rb_3_1.*qD_hF_2.*cos(q_hF_2).*cos(q_hS_2)-Rb_3_1.*qD_hS_2.*sin(q_hF_2).*sin(q_hS_2))+L3_R_1.*(cos(q_hS_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+Rb_3_2.*qD_hS_2.*sin(q_hS_2)+sin(q_hF_2).*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+Rb_3_1.*qD_hF_2.*cos(q_hF_2).*sin(q_hS_2)+Rb_3_1.*qD_hS_2.*cos(q_hS_2).*sin(q_hF_2))+L2_R_2.*cos(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L3_R_2.*cos(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_3.*Rb_3_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*qD_hF_2.*sin(q_hF_2)-L3_R_2.*Rb_3_1.*qD_hF_2.*sin(q_hF_2))-Ic_zz.*cos(q_hF_1).*(qD_hF_1.*wb_2.*cos(q_hF_1)+qD_hF_1.*wb_3.*sin(q_hF_1)).*2.0-Ic_zz.*cos(q_hF_2).*(qD_hF_2.*wb_2.*cos(q_hF_2)+qD_hF_2.*wb_3.*sin(q_hF_2)).*2.0+Ic_yy.*sin(q_hF_1).*(qD_hF_1.*wb_3.*cos(q_hF_1)-qD_hF_1.*wb_2.*sin(q_hF_1)).*2.0+Ic_yy.*sin(q_hF_2).*(qD_hF_2.*wb_3.*cos(q_hF_2)-qD_hF_2.*wb_2.*sin(q_hF_2)).*2.0-mh.*(vb_1+L1_L_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_L_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_1.*sin(q_hF_1)-Rb_1_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_L_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_L_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_L_2.*cos(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_L_3.*Rb_1_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_1_1.*qD_hF_1.*sin(q_hF_1))-mh.*(vb_1+L1_R_3.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-L1_R_2.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+Rb_1_2.*qD_hF_2.*sin(q_hF_2)-Rb_1_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L1_R_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)+L2_R_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+L2_R_2.*cos(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2)-L2_R_3.*Rb_1_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_1_1.*qD_hF_2.*sin(q_hF_2))-mh.*(vb_2+L1_L_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_L_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_1.*sin(q_hF_1)-Rb_2_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_L_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_L_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_L_2.*cos(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_L_3.*Rb_2_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_2_1.*qD_hF_1.*sin(q_hF_1))-mh.*(vb_2+L1_R_3.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-L1_R_2.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+Rb_2_2.*qD_hF_2.*sin(q_hF_2)-Rb_2_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L1_R_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)+L2_R_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+L2_R_2.*cos(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2)-L2_R_3.*Rb_2_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_2_1.*qD_hF_2.*sin(q_hF_2))-mh.*(vb_3+L1_L_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_L_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_2.*(cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_1.*sin(q_hF_1)-Rb_3_3.*qD_hF_1.*cos(q_hF_1))+L2_L_3.*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1))).*(L1_L_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_L_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_L_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_L_2.*cos(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_3.*sin(q_hF_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_L_3.*Rb_3_1.*qD_hF_1.*cos(q_hF_1)-L2_L_2.*Rb_3_1.*qD_hF_1.*sin(q_hF_1))-mh.*(vb_3+L1_R_3.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-L1_R_2.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_2.*(cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+Rb_3_2.*qD_hF_2.*sin(q_hF_2)-Rb_3_3.*qD_hF_2.*cos(q_hF_2))+L2_R_3.*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2))).*(L1_R_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L1_R_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)+L2_R_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+L2_R_2.*cos(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_3.*sin(q_hF_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2)-L2_R_3.*Rb_3_1.*qD_hF_2.*cos(q_hF_2)-L2_R_2.*Rb_3_1.*qD_hF_2.*sin(q_hF_2))+mh.*(L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0))+mh.*(L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0))+mh.*(L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+mh.*(L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0))+mk.*(L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_1.*sin(q_hF_1)-Rb_1_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))+Rb_1_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+wb_3.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_1_2.*wb_3-Rb_1_3.*wb_2).*2.0+Rb_1_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)+sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)-Rb_1_3.*qD_hF_2.*sin(q_hF_2)-Rb_1_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0+Rb_1_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_1_1.*wb_2-Rb_1_2.*wb_1)-wb_3.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_1_1.*wb_3-Rb_1_3.*wb_1)+wb_2.*(Rb_1_2.*wb_3-Rb_1_3.*wb_2))-Rb_1_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_1_1.*wb_2-Rb_1_2.*wb_1).*2.0-Rb_1_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_1_1.*wb_3-Rb_1_3.*wb_1).*2.0))+mk.*(L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_1.*sin(q_hF_1)-Rb_2_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))+Rb_2_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+wb_3.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_2_2.*wb_3-Rb_2_3.*wb_2).*2.0+Rb_2_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)+sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)-Rb_2_3.*qD_hF_2.*sin(q_hF_2)-Rb_2_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0+Rb_2_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_2_1.*wb_2-Rb_2_2.*wb_1)-wb_3.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_2_1.*wb_3-Rb_2_3.*wb_1)+wb_2.*(Rb_2_2.*wb_3-Rb_2_3.*wb_2))-Rb_2_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_2_1.*wb_2-Rb_2_2.*wb_1).*2.0-Rb_2_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_2_1.*wb_3-Rb_2_3.*wb_1).*2.0))+mk.*(L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1)).*(-L1_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_L_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_L_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_L_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_L_1.*(sin(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_1.^2.*cos(q_hS_1)+qD_hS_1.*sin(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_1.^2.*sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*cos(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)-L3_L_3.*(-cos(q_hS_1).*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_1).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_1.*cos(q_hS_1).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_1.^2.*sin(q_hS_1)+qD_hS_1.^2.*cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+qD_hS_1.*sin(q_hS_1).*(cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_1.*sin(q_hF_1)-Rb_3_2.*qD_hF_1.*cos(q_hF_1)).*2.0)+L2_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_L_3.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_1.^2.*sin(q_hF_1)-qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_L_2.*(cos(q_hF_1).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_1).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_1.^2.*cos(q_hF_1)+qD_hF_1.*cos(q_hF_1).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_1.^2.*sin(q_hF_1)+qD_hF_1.*sin(q_hF_1).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+mk.*(L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)).*(-L1_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+L1_R_2.*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+L1_R_3.*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-L2_R_1.*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-L3_R_1.*(sin(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+cos(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))+Rb_3_1.*qD_hS_2.^2.*cos(q_hS_2)+qD_hS_2.*sin(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0-qD_hS_2.^2.*sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*cos(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)-L3_R_3.*(-cos(q_hS_2).*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+sin(q_hS_2).*(wb_2.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+wb_3.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1))-qD_hS_2.*cos(q_hS_2).*(Rb_3_2.*wb_3-Rb_3_3.*wb_2).*2.0+Rb_3_1.*qD_hS_2.^2.*sin(q_hS_2)+qD_hS_2.^2.*cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+qD_hS_2.*sin(q_hS_2).*(cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)+sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)-Rb_3_3.*qD_hF_2.*sin(q_hF_2)-Rb_3_2.*qD_hF_2.*cos(q_hF_2)).*2.0)+L2_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0)+L2_R_3.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_3.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0+Rb_3_2.*qD_hF_2.^2.*sin(q_hF_2)-qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0)+L3_R_2.*(cos(q_hF_2).*(wb_1.*(Rb_3_1.*wb_2-Rb_3_2.*wb_1)-wb_3.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))+sin(q_hF_2).*(wb_1.*(Rb_3_1.*wb_3-Rb_3_3.*wb_1)+wb_2.*(Rb_3_2.*wb_3-Rb_3_3.*wb_2))-Rb_3_2.*qD_hF_2.^2.*cos(q_hF_2)+qD_hF_2.*cos(q_hF_2).*(Rb_3_1.*wb_2-Rb_3_2.*wb_1).*2.0-Rb_3_3.*qD_hF_2.^2.*sin(q_hF_2)+qD_hF_2.*sin(q_hF_2).*(Rb_3_1.*wb_3-Rb_3_3.*wb_1).*2.0))+Ic_yy.*qD_hF_1.*cos(q_hF_1).*(qD_hS_1+wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*qD_hF_2.*cos(q_hF_2).*(qD_hS_2+wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))+Ic_yy.*qD_hF_1.*cos(q_hF_1).*(wb_2.*cos(q_hF_1)+wb_3.*sin(q_hF_1))+Ic_yy.*qD_hF_2.*cos(q_hF_2).*(wb_2.*cos(q_hF_2)+wb_3.*sin(q_hF_2))-Ic_zz.*qD_hF_1.*sin(q_hF_1).*(wb_3.*cos(q_hF_1)-wb_2.*sin(q_hF_1)).*2.0-Ic_zz.*qD_hF_2.*sin(q_hF_2).*(wb_3.*cos(q_hF_2)-wb_2.*sin(q_hF_2)).*2.0];
end
if nargout > 2
    Bg = reshape([L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)),-L3_L_1.*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+L3_L_3.*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))-(l4b+l4a.*sin(q_kS_1)).*(Rb_1_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1)))+l4a.*cos(q_kS_1).*(Rb_1_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))),0.0,0.0,1.0,0.0,0.0,L2_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))-L2_L_3.*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+L3_L_2.*(Rb_1_3.*cos(q_hF_1)-Rb_1_2.*sin(q_hF_1))+L1_L_2.*Rb_1_3-L1_L_3.*Rb_1_2+L3_L_1.*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_1_2.*cos(q_hF_1)+Rb_1_3.*sin(q_hF_1)),(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1)).*(l4b+l4a.*sin(q_kS_1))-L3_L_1.*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_3.*(Rb_1_3.*sin(q_hS_1)-Rb_1_1.*cos(q_hF_1).*cos(q_hS_1))-L1_L_1.*Rb_1_3+L1_L_3.*Rb_1_1-L2_L_1.*Rb_1_3+L2_L_3.*Rb_1_1.*cos(q_hF_1)+L2_L_2.*Rb_1_1.*sin(q_hF_1)+L3_L_2.*Rb_1_1.*sin(q_hF_1)+l4a.*cos(q_kS_1).*(Rb_1_3.*cos(q_hS_1)+Rb_1_1.*cos(q_hF_1).*sin(q_hS_1)),L3_L_1.*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1))-(Rb_1_2.*sin(q_hS_1)+Rb_1_1.*cos(q_hS_1).*sin(q_hF_1)).*(l4b+l4a.*sin(q_kS_1))+L1_L_1.*Rb_1_2-L1_L_2.*Rb_1_1+L2_L_1.*Rb_1_2-l4a.*cos(q_kS_1).*(Rb_1_2.*cos(q_hS_1)-Rb_1_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_2.*Rb_1_1.*cos(q_hF_1)-L3_L_2.*Rb_1_1.*cos(q_hF_1)+L2_L_3.*Rb_1_1.*sin(q_hF_1),L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)),-L3_L_1.*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+L3_L_3.*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))-(l4b+l4a.*sin(q_kS_1)).*(Rb_2_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1)))+l4a.*cos(q_kS_1).*(Rb_2_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))),0.0,0.0,0.0,1.0,0.0,L2_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))-L2_L_3.*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+L3_L_2.*(Rb_2_3.*cos(q_hF_1)-Rb_2_2.*sin(q_hF_1))+L1_L_2.*Rb_2_3-L1_L_3.*Rb_2_2+L3_L_1.*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_2_2.*cos(q_hF_1)+Rb_2_3.*sin(q_hF_1)),(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1)).*(l4b+l4a.*sin(q_kS_1))-L3_L_1.*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_3.*(Rb_2_3.*sin(q_hS_1)-Rb_2_1.*cos(q_hF_1).*cos(q_hS_1))-L1_L_1.*Rb_2_3+L1_L_3.*Rb_2_1-L2_L_1.*Rb_2_3+L2_L_3.*Rb_2_1.*cos(q_hF_1)+L2_L_2.*Rb_2_1.*sin(q_hF_1)+L3_L_2.*Rb_2_1.*sin(q_hF_1)+l4a.*cos(q_kS_1).*(Rb_2_3.*cos(q_hS_1)+Rb_2_1.*cos(q_hF_1).*sin(q_hS_1)),L3_L_1.*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1))-(Rb_2_2.*sin(q_hS_1)+Rb_2_1.*cos(q_hS_1).*sin(q_hF_1)).*(l4b+l4a.*sin(q_kS_1))+L1_L_1.*Rb_2_2-L1_L_2.*Rb_2_1+L2_L_1.*Rb_2_2-l4a.*cos(q_kS_1).*(Rb_2_2.*cos(q_hS_1)-Rb_2_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_2.*Rb_2_1.*cos(q_hF_1)-L3_L_2.*Rb_2_1.*cos(q_hF_1)+L2_L_3.*Rb_2_1.*sin(q_hF_1),L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)),-L3_L_1.*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+L3_L_3.*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))-(l4b+l4a.*sin(q_kS_1)).*(Rb_3_1.*cos(q_hS_1)-sin(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1)))+l4a.*cos(q_kS_1).*(Rb_3_1.*sin(q_hS_1)+cos(q_hS_1).*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))),0.0,0.0,0.0,0.0,1.0,L2_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))-L2_L_3.*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+L3_L_2.*(Rb_3_3.*cos(q_hF_1)-Rb_3_2.*sin(q_hF_1))+L1_L_2.*Rb_3_3-L1_L_3.*Rb_3_2+L3_L_1.*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))+cos(q_hS_1).*(l4b+l4a.*sin(q_kS_1)).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-L3_L_3.*cos(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1))-l4a.*cos(q_kS_1).*sin(q_hS_1).*(Rb_3_2.*cos(q_hF_1)+Rb_3_3.*sin(q_hF_1)),(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1)).*(l4b+l4a.*sin(q_kS_1))-L3_L_1.*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1))-L3_L_3.*(Rb_3_3.*sin(q_hS_1)-Rb_3_1.*cos(q_hF_1).*cos(q_hS_1))-L1_L_1.*Rb_3_3+L1_L_3.*Rb_3_1-L2_L_1.*Rb_3_3+L2_L_3.*Rb_3_1.*cos(q_hF_1)+L2_L_2.*Rb_3_1.*sin(q_hF_1)+L3_L_2.*Rb_3_1.*sin(q_hF_1)+l4a.*cos(q_kS_1).*(Rb_3_3.*cos(q_hS_1)+Rb_3_1.*cos(q_hF_1).*sin(q_hS_1)),L3_L_1.*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))+L3_L_3.*(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1))-(Rb_3_2.*sin(q_hS_1)+Rb_3_1.*cos(q_hS_1).*sin(q_hF_1)).*(l4b+l4a.*sin(q_kS_1))+L1_L_1.*Rb_3_2-L1_L_2.*Rb_3_1+L2_L_1.*Rb_3_2-l4a.*cos(q_kS_1).*(Rb_3_2.*cos(q_hS_1)-Rb_3_1.*sin(q_hF_1).*sin(q_hS_1))-L2_L_2.*Rb_3_1.*cos(q_hF_1)-L3_L_2.*Rb_3_1.*cos(q_hF_1)+L2_L_3.*Rb_3_1.*sin(q_hF_1),0.0,0.0,L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)),-L3_R_1.*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+L3_R_3.*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))-(l4b+l4a.*sin(q_kS_2)).*(Rb_1_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2)))+l4a.*cos(q_kS_2).*(Rb_1_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))),1.0,0.0,0.0,L2_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))-L2_R_3.*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+L3_R_2.*(Rb_1_3.*cos(q_hF_2)-Rb_1_2.*sin(q_hF_2))+L1_R_2.*Rb_1_3-L1_R_3.*Rb_1_2+L3_R_1.*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_1_2.*cos(q_hF_2)+Rb_1_3.*sin(q_hF_2)),(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2)).*(l4b+l4a.*sin(q_kS_2))-L3_R_1.*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2))-L3_R_3.*(Rb_1_3.*sin(q_hS_2)-Rb_1_1.*cos(q_hF_2).*cos(q_hS_2))-L1_R_1.*Rb_1_3+L1_R_3.*Rb_1_1-L2_R_1.*Rb_1_3+L2_R_3.*Rb_1_1.*cos(q_hF_2)+L2_R_2.*Rb_1_1.*sin(q_hF_2)+L3_R_2.*Rb_1_1.*sin(q_hF_2)+l4a.*cos(q_kS_2).*(Rb_1_3.*cos(q_hS_2)+Rb_1_1.*cos(q_hF_2).*sin(q_hS_2)),L3_R_1.*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2))-(Rb_1_2.*sin(q_hS_2)+Rb_1_1.*cos(q_hS_2).*sin(q_hF_2)).*(l4b+l4a.*sin(q_kS_2))+L1_R_1.*Rb_1_2-L1_R_2.*Rb_1_1+L2_R_1.*Rb_1_2-l4a.*cos(q_kS_2).*(Rb_1_2.*cos(q_hS_2)-Rb_1_1.*sin(q_hF_2).*sin(q_hS_2))-L2_R_2.*Rb_1_1.*cos(q_hF_2)-L3_R_2.*Rb_1_1.*cos(q_hF_2)+L2_R_3.*Rb_1_1.*sin(q_hF_2),0.0,0.0,L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)),-L3_R_1.*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+L3_R_3.*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))-(l4b+l4a.*sin(q_kS_2)).*(Rb_2_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2)))+l4a.*cos(q_kS_2).*(Rb_2_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))),0.0,1.0,0.0,L2_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))-L2_R_3.*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+L3_R_2.*(Rb_2_3.*cos(q_hF_2)-Rb_2_2.*sin(q_hF_2))+L1_R_2.*Rb_2_3-L1_R_3.*Rb_2_2+L3_R_1.*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_2_2.*cos(q_hF_2)+Rb_2_3.*sin(q_hF_2)),(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2)).*(l4b+l4a.*sin(q_kS_2))-L3_R_1.*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2))-L3_R_3.*(Rb_2_3.*sin(q_hS_2)-Rb_2_1.*cos(q_hF_2).*cos(q_hS_2))-L1_R_1.*Rb_2_3+L1_R_3.*Rb_2_1-L2_R_1.*Rb_2_3+L2_R_3.*Rb_2_1.*cos(q_hF_2)+L2_R_2.*Rb_2_1.*sin(q_hF_2)+L3_R_2.*Rb_2_1.*sin(q_hF_2)+l4a.*cos(q_kS_2).*(Rb_2_3.*cos(q_hS_2)+Rb_2_1.*cos(q_hF_2).*sin(q_hS_2)),L3_R_1.*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2))-(Rb_2_2.*sin(q_hS_2)+Rb_2_1.*cos(q_hS_2).*sin(q_hF_2)).*(l4b+l4a.*sin(q_kS_2))+L1_R_1.*Rb_2_2-L1_R_2.*Rb_2_1+L2_R_1.*Rb_2_2-l4a.*cos(q_kS_2).*(Rb_2_2.*cos(q_hS_2)-Rb_2_1.*sin(q_hF_2).*sin(q_hS_2))-L2_R_2.*Rb_2_1.*cos(q_hF_2)-L3_R_2.*Rb_2_1.*cos(q_hF_2)+L2_R_3.*Rb_2_1.*sin(q_hF_2),0.0,0.0,L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)),-L3_R_1.*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+L3_R_3.*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))-(l4b+l4a.*sin(q_kS_2)).*(Rb_3_1.*cos(q_hS_2)-sin(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2)))+l4a.*cos(q_kS_2).*(Rb_3_1.*sin(q_hS_2)+cos(q_hS_2).*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))),0.0,0.0,1.0,L2_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))-L2_R_3.*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+L3_R_2.*(Rb_3_3.*cos(q_hF_2)-Rb_3_2.*sin(q_hF_2))+L1_R_2.*Rb_3_3-L1_R_3.*Rb_3_2+L3_R_1.*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))+cos(q_hS_2).*(l4b+l4a.*sin(q_kS_2)).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-L3_R_3.*cos(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2))-l4a.*cos(q_kS_2).*sin(q_hS_2).*(Rb_3_2.*cos(q_hF_2)+Rb_3_3.*sin(q_hF_2)),(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2)).*(l4b+l4a.*sin(q_kS_2))-L3_R_1.*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2))-L3_R_3.*(Rb_3_3.*sin(q_hS_2)-Rb_3_1.*cos(q_hF_2).*cos(q_hS_2))-L1_R_1.*Rb_3_3+L1_R_3.*Rb_3_1-L2_R_1.*Rb_3_3+L2_R_3.*Rb_3_1.*cos(q_hF_2)+L2_R_2.*Rb_3_1.*sin(q_hF_2)+L3_R_2.*Rb_3_1.*sin(q_hF_2)+l4a.*cos(q_kS_2).*(Rb_3_3.*cos(q_hS_2)+Rb_3_1.*cos(q_hF_2).*sin(q_hS_2)),L3_R_1.*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))+L3_R_3.*(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2))-(Rb_3_2.*sin(q_hS_2)+Rb_3_1.*cos(q_hS_2).*sin(q_hF_2)).*(l4b+l4a.*sin(q_kS_2))+L1_R_1.*Rb_3_2-L1_R_2.*Rb_3_1+L2_R_1.*Rb_3_2-l4a.*cos(q_kS_2).*(Rb_3_2.*cos(q_hS_2)-Rb_3_1.*sin(q_hF_2).*sin(q_hS_2))-L2_R_2.*Rb_3_1.*cos(q_hF_2)-L3_R_2.*Rb_3_1.*cos(q_hF_2)+L2_R_3.*Rb_3_1.*sin(q_hF_2)],[10,6]);
end
